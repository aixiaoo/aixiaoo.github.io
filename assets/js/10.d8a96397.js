(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{354:function(s,a,t){"use strict";t.r(a);var e=t(43),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"ip盾构机"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ip盾构机"}},[s._v("#")]),s._v(" IP盾构机")]),s._v(" "),t("h2",{attrs:{id:"简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[s._v("#")]),s._v(" 简介")]),s._v(" "),t("p",[s._v("为了方便用户管理大量服务器，本软件提供了WEB面板用于在线管理服务器的转发规则。")]),s._v(" "),t("p",[s._v("目前该软件实现了以下功能：")]),s._v(" "),t("ul",[t("li",[s._v("在线管理iptables规则。")]),s._v(" "),t("li",[s._v("在线管理Brook转发规则。")]),s._v(" "),t("li",[s._v("在线管理Gost隧道转发规则 。")]),s._v(" "),t("li",[s._v("端口流量统计（支持每月流量重置、超量挂起）。")]),s._v(" "),t("li",[s._v("端口流量限速。")])]),s._v(" "),t("h2",{attrs:{id:"服务端部署："}},[t("a",{staticClass:"header-anchor",attrs:{href:"#服务端部署："}},[s._v("#")]),s._v(" 服务端部署：")]),s._v(" "),t("h3",{attrs:{id:"环境要求："}},[t("a",{staticClass:"header-anchor",attrs:{href:"#环境要求："}},[s._v("#")]),s._v(" 环境要求：")]),s._v(" "),t("ol",[t("li",[s._v("php7.1+(推荐7.2)")]),s._v(" "),t("li",[s._v("mysql5.6+")]),s._v(" "),t("li",[s._v("nginx")])]),s._v(" "),t("h3",{attrs:{id:"_1-上传源代码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-上传源代码"}},[s._v("#")]),s._v(" 1.上传源代码")]),s._v(" "),t("p",[s._v("上传源代码设置public文件夹为运行目录(注意，文件不包含Master文件夹)。")]),s._v(" "),t("h3",{attrs:{id:"_2-伪静态"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-伪静态"}},[s._v("#")]),s._v(" 2.伪静态")]),s._v(" "),t("p",[s._v("Nginx伪静态配置：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("location /{     \n    if (!-e $request_filename) {       \n        rewrite ^/(.*)$ /index.php/$1 last;       \n        break;     \n    }    \n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("Apache伪静态（.htaccess在public文件夹下)配置：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("<IfModule mod_rewrite.c>\n\nRewriteEngine on\n\nRewriteCond %{REQUEST_FILENAME} !-d\n\nRewriteCond %{REQUEST_FILENAME} !-f\n\nRewriteRule ^(.*)$ index.php/$1 [QSA,PT,L]\n\n</IfModule>\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h3",{attrs:{id:"_3-定时任务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-定时任务"}},[s._v("#")]),s._v(" 3.定时任务")]),s._v(" "),t("p",[s._v("设置定时任务")]),s._v(" "),t("p",[s._v("安装curl")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -y\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("设定定时任务（5分钟执行一次）")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("crontab")]),s._v(" -e\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("添加定时任务，请替换网址为你自己的")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("*/5 * * * * "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" https://网址/cron\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"数据库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据库"}},[s._v("#")]),s._v(" 数据库")]),s._v(" "),t("p",[s._v("导入数据库（test.sql）数据库配置文件app/config.php 默认用户名密码为：admin 123456")]),s._v(" "),t("h2",{attrs:{id:"被控端部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#被控端部署"}},[s._v("#")]),s._v(" 被控端部署")]),s._v(" "),t("h3",{attrs:{id:"环境要求"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#环境要求"}},[s._v("#")]),s._v(" 环境要求")]),s._v(" "),t("p",[s._v("仅推荐使用debian9！")]),s._v(" "),t("p",[s._v("如果是centos7，请自行升级iptables版本，参考：https://www.bnxb.com/linuxserver/27546.html")]),s._v(" "),t("h3",{attrs:{id:"iptable、brook转发"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#iptable、brook转发"}},[s._v("#")]),s._v(" iptable、Brook转发")]),s._v(" "),t("h4",{attrs:{id:"_1-转发机初始化："}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-转发机初始化："}},[s._v("#")]),s._v(" 1.转发机初始化：")]),s._v(" "),t("p",[s._v("执行Shell：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" http://cdn-hk.taoluyun.cc/ip_control.sh "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x ip_control.sh\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v(" ip_control.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("选择 执行选项 《1》。")]),s._v(" "),t("h4",{attrs:{id:"_2-手动加定时任务（请自行替换网址和key，注意不要丢掉空格）："}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-手动加定时任务（请自行替换网址和key，注意不要丢掉空格）："}},[s._v("#")]),s._v(" 2.手动加定时任务（请自行替换网址和key，注意不要丢掉空格）：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("*/5 * * * * "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" /etc/profile"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("ip_table -url http://baidu.com -key XXXXXXX\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("主控端部署完毕，您可以手动执行该命令查看执行是否有问题：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("ip_table -url http://baidu.com -key XXXXXXX\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"gost隧道转发"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#gost隧道转发"}},[s._v("#")]),s._v(" Gost隧道转发")]),s._v(" "),t("p",[s._v("一部分是转发机（国内端），另一部分是落地机（国外端）。")]),s._v(" "),t("h4",{attrs:{id:"_1-转发机初始化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-转发机初始化"}},[s._v("#")]),s._v(" 1.转发机初始化")]),s._v(" "),t("p",[s._v("同iptable、Brook转发。")]),s._v(" "),t("h4",{attrs:{id:"_2-落地机初始化-请注意开放防火墙哦"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-落地机初始化-请注意开放防火墙哦"}},[s._v("#")]),s._v(" 2.落地机初始化(请注意开放防火墙哦)")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" http://cdn-hk.taoluyun.cc/ip_control.sh "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x ip_control.sh\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v(" ip_control.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("选择 执行选项 《2》。")]),s._v(" "),t("h4",{attrs:{id:"_3-添加定时任务（请自行替换网址和key，注意不要丢掉空格）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-添加定时任务（请自行替换网址和key，注意不要丢掉空格）"}},[s._v("#")]),s._v(" 3.添加定时任务（请自行替换网址和key，注意不要丢掉空格）")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("*/5 * * * * "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" /etc/profile"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("iptables_gost -url http://baidu.com -key XXXXXXX\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"更新日志"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#更新日志"}},[s._v("#")]),s._v(" 更新日志")]),s._v(" "),t("h3",{attrs:{id:"_1-1-0-1-1-3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-0-1-1-3"}},[s._v("#")]),s._v(" 1.1.0 -> 1.1.3")]),s._v(" "),t("p",[s._v("更新内容：")]),s._v(" "),t("ul",[t("li",[s._v("授权域名更新。")]),s._v(" "),t("li",[s._v("修复流量重置问题。")]),s._v(" "),t("li",[s._v("更新宽松模式。")]),s._v(" "),t("li",[s._v("普通用户不能新增规则，可以修改规则。")]),s._v(" "),t("li",[s._v("修复限速与重置日不填写，导致规则添加失败的bug。")])]),s._v(" "),t("p",[s._v("更新方式：在线更新。")]),s._v(" "),t("h3",{attrs:{id:"_1-0-1-1-1-0"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-0-1-1-1-0"}},[s._v("#")]),s._v(" 1.0.1 -> 1.1.0")]),s._v(" "),t("p",[s._v("更新内容：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("更新在线升级。")])]),s._v(" "),t("li",[t("p",[s._v("添加规则，添加默认值。")])]),s._v(" "),t("li",[t("p",[s._v("可选：关闭严格模式。")]),s._v(" "),t("p",[s._v("现在默认的就是严格模式，同IP转发到同目的地同端口，提示：同服务器禁止转发到同IP的同端口，或者关闭严格模式。\n关闭严格模式：允许以上行为，但实际流量统计和限速不生效。")])]),s._v(" "),t("li",[t("p",[s._v("节点可以对应多台服务器，多的机器需要额外加网卡名和内网ip参数")]),s._v(" "),t("p",[s._v("（例如：ip_tables -key xxxxx -eth eth0 -ip 1.1.1.1）。")])]),s._v(" "),t("li",[t("p",[s._v("增加了纯relay转发，修复了若干bug。")])]),s._v(" "),t("li",[t("p",[s._v("修复了流量重置Bug。")])])]),s._v(" "),t("p",[s._v("数据库SQL执行：")]),s._v(" "),t("div",{staticClass:"language-mysql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("ALTER TABLE `config`\nCHANGE `key` `ip_key` varchar(255) COLLATE 'utf8_general_ci' NULL AFTER `id`,\nCHANGE `value` `ip_value` text COLLATE 'utf8_general_ci' NULL AFTER `ip_key`;\n\nALTER TABLE `server_list`\nADD `check_mode` tinyint(255) NOT NULL DEFAULT '0' COMMENT '0:严格，1:宽松' AFTER `dynamic_enable`;\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("安装包覆盖：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("http://cdn-hk.taoluyun.cc/update/1.1.0-update.zip\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("删除"),t("code",[s._v("/app/runtime")]),s._v("文件夹（清理模板缓存）")]),s._v(" "),t("h3",{attrs:{id:"_1-0-0-1-0-1"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-0-0-1-0-1"}},[s._v("#")]),s._v(" 1.0.0 -> 1.0.1")]),s._v(" "),t("p",[s._v("更新内容：")]),s._v(" "),t("ul",[t("li",[s._v("修复取消用户服务器权限，所有人改服务器权限都取消的bug。")]),s._v(" "),t("li",[s._v("现在超级管理员无需添加服务器权限即可管理查看所有服务器。")]),s._v(" "),t("li",[s._v("描述文字更改。")]),s._v(" "),t("li",[s._v("流量重置无需另外添加定时任务。")]),s._v(" "),t("li",[s._v("修复了主控访问出错，被控规则被删除的Bug。")]),s._v(" "),t("li",[s._v("被控文件添加了全局数组越界处理。")])]),s._v(" "),t("p",[s._v("数据库SQL执行：")]),s._v(" "),t("div",{staticClass:"language-mysql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("ALTER TABLE `server_rules`\nCHANGE `reset_day` `reset_day` tinyint NOT NULL DEFAULT '0' AFTER `traffic_used`,\nADD `last_reset_day` tinyint NOT NULL DEFAULT '0' AFTER `reset_day`;\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("安装包覆盖：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("http://cdn-hk.taoluyun.cc/update/1.0.1-update.zip\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("删除"),t("code",[s._v("/app/runtime")]),s._v("文件夹（清理模板缓存）")]),s._v(" "),t("p",[s._v("重新下载部署被控。（修复了主控访问出错，被控规则被删除的Bug）")]),s._v(" "),t("h2",{attrs:{id:"常见问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#常见问题"}},[s._v("#")]),s._v(" 常见问题")]),s._v(" "),t("h3",{attrs:{id:"_1-用户列表里的身份是什么意思。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-用户列表里的身份是什么意思。"}},[s._v("#")]),s._v(" 1.用户列表里的身份是什么意思。")]),s._v(" "),t("p",[s._v("答：1.超级管理员可以看到全局的规则，自由添加删除服务器 2.管理员不能添加删除服务器，只能看到和管理自己分配到的服务器 3.用户不能添加删除服务器，不能删除规则，不能修改限速大小，流量大小，流量重置日")]),s._v(" "),t("h3",{attrs:{id:"_2-流量是做什么的"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-流量是做什么的"}},[s._v("#")]),s._v(" 2.流量是做什么的")]),s._v(" "),t("p",[s._v("答：统计用户流量。如果设定了上限，超额流量的规则将挂起。除非增加上限才能启用 C。落地服务器是干啥的。 GOST时需要有落地服务器，此时落地服务器的KEY，不要填写成转发机的KEY了")])])}),[],!1,null,null,null);a.default=r.exports}}]);